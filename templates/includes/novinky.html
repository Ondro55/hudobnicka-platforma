<!-- templates/includes/novinky.html -->
<section class="news">
  <!-- ğŸ†• NovÃ© dopyty -->
  <div class="news-box linkbox"
       data-href="{{ url_for('dopyty.zobraz_dopyty') }}"
       role="link" tabindex="0">
    <h2>NovÃ© dopyty:</h2>
    <ul>
      {% for d in novinky_dopyty %}
        {% set typ = d.typ_akcie|title if d.typ_akcie else 'Dopyt' %}
        {% set miesto = (d.miesto or (d.mesto.nazov if d.mesto else '')) %}
        {% set datum = d.datum.strftime('%d.%m.%Y') if d.datum else '' %}
        {% set cena = ('cena dohodou' if d.rozpocet is none else ('%.0f â‚¬'|format(d.rozpocet))) %}

        <li class="nov-row">
          <span class="nov-line">
            {{ typ }}{% if miesto %} â€“ {{ miesto }}{% endif %}
            {% if datum %} â€“ {{ datum }}{% endif %}
            â€“ {{ cena }}
          </span>
        </li>
      {% else %}
        <li class="muted">ZatiaÄ¾ Å¾iadne novÃ© dopyty.</li>
      {% endfor %}
    </ul>
  </div>

  <!-- ostatnÃ© boxy nechaj, ako mÃ¡Å¡ -->
  <div class="news-box">
    <h2>Novinky v komunite:</h2>
    <ul>
      <li><a href="#">ğŸ‰ Festival v Å½iari uÅ¾ Äoskoro</a></li>
      <li><a href="#">ğŸ¤ HÄ¾adÃ¡ sa novÃ½ spevÃ¡k do kapely X</a></li>
      <li><a href="#">ğŸ» Workshop tradiÄnÃ½ch nÃ¡strojov</a></li>
    </ul>
  </div>

  <div class="news-box">
    <h2>Novinky v bazÃ¡ri:</h2>
    <p>ğŸº TrÃºbka Yamaha YTR-4335GII len za 250 â‚¬!</p>
  </div>

  <div class="news-box">
    <h2>Novinky v e-shope:</h2>
    <p>ğŸ¶ NovÃ© Ä¾udovÃ© CD â€Na salaÅ¡iâ€œ teraz s 10% zÄ¾avou.</p>
  </div>
</section>

<script>
// celÃ½ box â€NovÃ© dopytyâ€œ â†’ /dopyty
document.addEventListener('click', (e) => {
  const box = e.target.closest('.linkbox[data-href]');
  if (!box || e.target.closest('a')) return; // ak klikol na vnÃºtornÃ½ <a>, nechaj pÃ´vodnÃ½ link
  window.location.href = box.dataset.href;
});
document.addEventListener('keydown', (e) => {
  const box = e.target.closest('.linkbox[data-href]');
  if (!box) return;
  if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); window.location.href = box.dataset.href; }
});
</script>

