{% extends 'base.html' %}
{% block title %}Muzikuj.sk ‚Äì Domov{% endblock %}

{% block home_content %}
  {# ========== STREDN√ù FEED ========== #}
  <div id="home-feed">
    {% if feed and feed|length %}
      {% for kind, ts, obj in feed %}
        <article class="feed-card {{ 'is-ad' if kind=='ad' else 'is-event' }}">
          <img src="{{ obj.foto_url }}" alt="" class="cover">
          <div class="copy">
            {% if kind == 'event' %}
              <h3 class="title">{{ obj.nazov }}</h3>
              <div class="meta">
                {{ obj.start_dt|localtime('%d.%m.%Y %H:%M') }}{% if obj.miesto %} ‚Ä¢ {{ obj.miesto }}{% endif %}
              </div>
              {% if obj.organizator %}<div class="meta">{{ obj.organizator }}</div>{% endif %}
            {% else %}
              <h3 class="title">Promo: {{ obj.nazov }} {% if obj.is_top %}<span class="badge">TOP</span>{% endif %}</h3>
              {% if obj.text %}<p class="desc">{{ obj.text }}</p>{% endif %}
              {% if obj.url %}<a class="link" href="{{ obj.url }}" target="_blank" rel="noopener">Viac ¬ª</a>{% endif %}
            {% endif %}
          </div>
        </article>
      {% endfor %}
    {% else %}
      <p class="empty">Zatiaƒæ ≈æiadne novinky.</p>
    {% endif %}
  </div>

  <style>
    #home-feed{ max-width: 720px; margin: 0 auto; }
    .feed-card{ border:1px solid #eee; border-radius:12px; overflow:hidden; background:#fff; margin-bottom:12px; }
    .feed-card.is-ad{ border-left:4px solid rgba(182,140,98,.45); }
    .feed-card .cover{ width:100%; height:320px; object-fit:cover; display:block; }
    .feed-card .copy{ padding:12px 14px; }
    .feed-card .title{ margin:0 0 6px 0; font-size:1.1rem; }
    .feed-card .badge{ background:#e6d2b8; padding:.05rem .4rem; border-radius:.4rem; font-size:.8rem; }
    .feed-card .meta{ color:#666; font-size:.95rem; }
    .feed-card .desc{ margin:.35rem 0 0; }
    .empty{ color:#666; text-align:center; padding:20px 0; }
    @media (max-width:640px){ .feed-card .cover{ height:220px; } }
  </style>

 
  {# ===== MODAL ‚ÄûZada≈• dopyt‚Äú ‚Äì unifikovan√© triedy ===== #}
  <div id="dopyt-form" class="modal-root" hidden aria-hidden="true" role="dialog" aria-labelledby="dopyt-title">
    <div class="modal-backdrop" data-modal-close></div>
    <div class="modal-card">
      <form id="form-dopyt" method="POST" action="#">
        <h3 id="dopyt-title">üì¢ Zada≈• dopyt</h3>

        <div class="form-fields">
          <label>N√°zov dopytu
            <input type="text" name="nazov" placeholder="Hƒæad√°m kapelu na svadbu" required>
          </label>

          <div class="row-2">
            <label>D√°tum
              <input type="date" name="datum" required>
            </label>
            <label>ƒåas (od ‚Äì do)
              <input type="text" name="cas" placeholder="19:00 ‚Äì 00:00">
            </label>
          </div>

          <div class="row-2">
            <label>Mesto / Obec
              <input type="text" name="mesto" placeholder="Bratislava" required>
            </label>
            <label>Rozpoƒçet (EUR)
              <input type="number" name="rozpocet" min="0" step="1" placeholder="500">
            </label>
          </div>

          <label>Popis
            <textarea name="popis" rows="6" placeholder="Typ akcie, ≈æ√°ner, dƒ∫≈æka hrania, technick√© po≈æiadavky‚Ä¶" required></textarea>
          </label>

          <div class="row-2">
            <label>Kontakt (e-mail)
              <input type="email" name="email" placeholder="tvoj@email.sk" required>
            </label>
            <label>Telef√≥n
              <input type="tel" name="telefon" placeholder="+421 9..">
            </label>
          </div>
        </div>

        <div class="modal-actions">
          <button type="button" class="btn" data-modal-close>Zavrie≈•</button>
          <button type="submit" class="btn primary">Odosla≈• dopyt</button>
        </div>
      </form>
    </div>
  </div>
{% endblock %}

{% block home_right %}
  {# prav√Ω stƒ∫pec ‚Äì zatiaƒæ pr√°zdny alebo novinky nesk√¥r #}
{% endblock %}
